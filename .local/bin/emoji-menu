#!/bin/sh
# Emoji selection menu

emoji_cache="$HOME/.cache/script-cache/emoji_list.txt"
emoji_url="https://unicode.org/Public/emoji/latest/emoji-test.txt"

[ ! -s "$emoji_cache" ] && {
  notify-send "Fetching emoji list..."
  mkdir -p "$(dirname $emoji_cache)"
  curl -s "$emoji_url" | awk '
  /; fully-qualified/ && !/skin tone/ {
    sub(/.*# /, "")
    sub(/ E[0-9.]+/, "")
    print
  }' > "$emoji_cache" && notify-send "Done!"
}

chosen=$(cat "$emoji_cache" | mew -p "Select emoji:" -i | awk '{ print $1 }')

[ "$chosen" ] && { 
  printf "$chosen" | wl-copy && \
  notify-send "Emoji copied: $chosen"
} || exit 1
