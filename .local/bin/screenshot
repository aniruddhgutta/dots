#!/bin/sh
# Screenshot utility

usage() {
  printf "usage: ${0##*/} [-a|-f] [-o output] [-s output-file]\n"
  exit 1
}

while getopts "o:afsh" arg; do case $arg in
  o) out="$OPTARG" ;;
  a) sel="$(wfreeze slurp)" ;;
  f) full=1 ;;
  s) save=1 ;;
  *) usage ;;
esac; done
shift $((OPTIND-1))

[ -z "$sel" ] && [ -z "$full" ] && usage

[ "$save" ] && {
  : "${file:=${1:-$HOME/pics/screenshots/$(date +%F-%T).png}}"
  msg="Saved to <span color='#85AEF1'>${file##*/}</span>"
}

grim ${out:+-o "$out"} ${sel:+-g "$sel"} ${full:+} "${file:-/tmp/ss.png}"
wl-copy -t image/png < "${file:-/tmp/ss.png}"
notify-send "Screenshot taken!" "${msg:-Copied to clipboard}"
